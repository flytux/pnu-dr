apiVersion: v1
kind: ConfigMap
data:
  sync-svn-git.sh: |-
    #!/bin/bash    
     cd $HOME    
     rm -rf workspace 
     mkdir workspace && cd workspace  
     echo "=== CHECKOUT SVN REPO ==="   
     svn co --username tekton --password 1 svn://203.232.240.31:30690/pnu-sugang-nginx   
     echo "=== CONFIG GIT ==="    
     echo "http://gitea:gitea123@gitea-dr.pnu.ac.kr" > ~/.git-credentials   
     git config --global user.email tekton@pun.ac.kr   
     git config --global credential.helper store    
     echo "=== CLONE GIT ==="   
     git clone http://gitea-dr.pnu.ac.kr/gitea/pnu-sugang-nginx tmp   
     echo "=== ADD MIRROR DATE ==="   
     rm -f tmp/SVN_MIRROR_DATE   
     echo "SVN repo mirrored at" + $(date +%F-%H-%M-%S) > tmp/SVN_MIRROR_DATE   
     echo "=== COPY SVN to GIT ==="    
     cp -R pnu-sugang-nginx/* tmp/    
     cd tmp    
     git add .    
     git commit -m "update: SVN source $(date)"    
     git push -u origin main
