<div id="popups" >
	<section class="sec-1">
		<div class="sec-body">
			<div class="table-box" id=grid01>
					<div class="table-body">
						
						<table class="table table-hover" data-toggle="table"  data-show-column="true" >
							<caption>교과목정보</caption>
							<colgroup>
								<col style="min-width: 30px;"> <!-- NO -->
 								<col style="min-width: 100px;"> <!-- 교과목명 -->
								<col style="min-width: 100px;"> <!-- 교과목번호 -->
								<col style="min-width: 50px;"><!-- 분반 -->
								<col style="min-width: 100px;"><!-- 교과목구분 -->
								<col style="min-width: 50px;"> <!-- 학점 -->
								<col style="min-width: 150px;"> <!-- 신청인원/대상인원 -->
								<col style="min-width: 70px;"><!-- 주전공 -->
								<col style="min-width: 70px;"><!-- 부/복수/연합/교직 -->
								<col style="min-width: 80px;"><!-- 일반선택 -->
								<col style="min-width: 70px;"><!-- 타대생  -->
								<col style="min-width: 70px;"><!-- 주전공 -->
								<col style="min-width: 150px;"><!-- 부/복수/연합/교직 -->
								<col style="min-width: 80px;"><!-- 일반선택 -->
								<col style="min-width: 70px;"><!-- 타대생  -->
							</colgroup>
							<thead>
								<tr>
									<th rowspan="2" class="rowspan" >NO</th>
									<th rowspan="2" class="rowspan" >교과목명</th>
									<th rowspan="2" class="rowspan" >교과목번호</th>
									<th rowspan="2" class="rowspan">분반</th>
									<th rowspan="2" class="rowspan">교과목구분</th>
									<th rowspan="2" class="rowspan">학점</th>
									<th rowspan="2" class="rowspan">신청인원/대상인원</th>
									<th colspan="4">희망인원</th>
									<th colspan="4">배정인원</th>
								</tr>
								<tr>
									<th scope="col" >주전공</th>
									<th scope="col" >부/복수/연합/교직</th>
									<th scope="col" >일반선택</th>
									<th scope="col" >타대생</th>
									<th scope="col" >주전공</th>
									<th scope="col" >부/복수/연합/교직</th>
									<th scope="col" >일반선택</th>
									<th scope="col" >타대생</th>
								</tr>
							</thead>
							<tbody id="PopResultTbody">
							</tbody>
						</table>
					</div>
				</div>
		</div>
	</section>
</div>
<script type="text/x-tbody-template" id="PopResultTemplate">
	<tr style="cursor:pointer;">
		<td>#:ROWNUM#</td>
		<td class="text-left">#:SUBJ_NM#</td>
		<td>#:SUBJ_NO#</td>
		<td>#:CLASS_NO#</td>
		<td class="text-left">#:SUBJ_GCD_NM#</td>
		<td>#:CRDT#</td>
		<td class="text-right">#:APLY_CNT#</td>
		<td class="text-right">#:MAJOR_BASKET_INWON_CNT#</td>
		<td class="text-right">#:MULTI_MAJOR_BASKET_INWON_CNT#</td>
		<td class="text-right">#:GENERAL_SELECT_BASKET_INWON_CNT#</td>
		<td class="text-right">#:EXUNIV_STDT_BASKET_INWON_CNT#</td>
		<td class="text-right">#:MAJOR_ALLOC_INWON_CNT#</td>
		<td class="text-right">#:MULTI_MAJOR_ALLOC_INWON_CNT#</td>
		<td class="text-right">#:GENERAL_SELECT_ALLOC_INWON_CNT#</td>
		<td class="text-right">#:EXUNIV_STDT_ALLOC_INWON_CNT#</td>	
	</tr>
</script>
<script type="text/javascript">



$(document).ready(popInit());

function popInit() {
	
	setTimeout(() => {
		//$(".rowspan").children('.th-inner').css("height","75px")
	}, 1);
	
	
	gfn_com_dataBind($("#popups"), scwin.detailObj);
	      
	data = gfn_com_searchData($(".search-box"));

	if (gfn_com_isEmptyObject(data)) {
		data = scwin.detailObj.popupParam;
    }else{
    	data.SCH_SYEAR = scwin.detailObj.popupParam.SCH_SYEAR;
    	data.SCH_TERM_GCD = scwin.detailObj.popupParam.SCH_TERM_GCD;
    	data.COLL_GRAD_GCD = scwin.detailObj.popupParam.COLL_GRAD_GCD;
    	data.USER_ID = scwin.detailObj.popupParam.USER_ID;
    	data.GBN = scwin.detailObj.popupParam.GBN;
    }
	
	fn_Popsch(data);
}


function fn_Popsch(data){
	if (gfn_com_isEmptyObject(data)) {
		data = gfn_com_searchData($("#popups").find(".search-box"));
	}
	data.SCH_SYEAR = scwin.detailObj.popupParam.SCH_SYEAR;
	data.SCH_TERM_GCD = scwin.detailObj.popupParam.SCH_TERM_GCD;
	data.COLL_GRAD_GCD = scwin.detailObj.popupParam.COLL_GRAD_GCD;
	data.USER_ID = scwin.detailObj.popupParam.USER_ID;
	data.GBN = scwin.detailObj.popupParam.GBN;
		
	const ajaxPath = '/ost/cls/lecaplycheck/BasketApplyInwonSearch';
	gfn_ajax_request({
		url : ajaxPath + '/selectQuerySearch',
		reqData : data,
		success : function(data, responseData) {            	
			
        	$("#PopResultTbody").listView({
                dataSource : data,
                emptyComment:'등록된 신청인원확인 목록이 없습니다.',
                dataBound : function(e) {
                	totalCnt = responseData.pageInfo.totCnt;
                    currentData = data;
                },
                template : $("#PopResultTemplate"),
                totalCnt : responseData.pageInfo.totalCnt,
                paging : {
                    pageInfo : responseData.pageInfo,
                    reqData : responseData.reqData,
                    func : "fn_Popsch"
                }, 
                excel : "fn_excelDownload01"
            });
        }
	});
	

}
function fn_excelDownload01() {

	data.SCH_SYEAR = scwin.detailObj.popupParam.SCH_SYEAR;
	data.SCH_TERM_GCD = scwin.detailObj.popupParam.SCH_TERM_GCD;
	data.COLL_GRAD_GCD = scwin.detailObj.popupParam.COLL_GRAD_GCD;
	data.USER_ID = scwin.detailObj.popupParam.USER_ID;
	data.GBN = scwin.detailObj.popupParam.GBN;
		
	
	excel_title = data.GBN ==='1'? "상세 희망과목담기 신청인원확인" : "전체 희망과목담기 신청인원확인"
	data.pageSize = totalCnt; //전체데이터를 가지고 오기 위해서 pageSize를 전체건수로 세팅
	gfn_ajax_request({
		url : "/ost/cls/lecaplycheck/BasketApplyInwonSearch/selectQuerySearch",
		reqData : data,
		success : function(data, responseData) {
			if (data.length > 0) {
				/* [엑셀다운로드 공통] */
				gfn_com_excelDownloadFile([ {
					key : "ROWNUM",
					name : "NO"
				},{
					key : "SUBJ_NM",
					name : "교과목명"
				}, {
					key : "SUBJ_NO",
					name : "교과목번호"
				}, {
					key : "CLASS_NO",
					name : "분반"
				}, {
					key : "SUBJ_GCD_NM",
					name : "교과목구분"
				}, {
					key : "CRDT",
					name : "학점"
				}, {
					key : ":APLY_CNT",
					name : "신청인원/대상인원"
				}, {
					key : "MAJOR_BASKET_INWON_CNT",
					name : "희망인원_주전공"
				}, {
					key : "MULTI_MAJOR_BASKET_INWON_CNT",
					name : "희망인원_부/복수/연합/교직"
				}, {
					key : "GENERAL_SELECT_BASKET_INWON_CNT",
					name : "희망인원_일반선택"
				}, {
					key : "EXUNIV_STDT_BASKET_INWON_CNT",
					name : "희망인원_타대생"
				}, {
					key : "MAJOR_ALLOC_INWON_CNT",
					name : "배정인원_주전공"
				}, {
					key : "MULTI_MAJOR_ALLOC_INWON_CNT",
					name : "배정인원_부/복수/연합/교직"
				}, {
					key : "GENERAL_SELECT_ALLOC_INWON_CNT",
					name : "배정인원_일반선택"
				}, {
					key : "EXUNIV_STDT_ALLOC_INWON_CNT",
					name : "배정인원_타대생"
				}], /* 엑셀에 표시할 컬럼 및 명칭 */
				data, /* 엑셀로 다운로드 할 데이터 */
				excel_title/* 엑셀로 다운로드 할 파일명 (확장자제외) */
				);
			} else {
				alert("엑셀로 다운로드할 데이터가 없습니다.");
				return false;
			}
		}
	})
};
</script>