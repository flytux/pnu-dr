<div id="popups">
	<section class="sec-1">
		<div class="sec-body">
			<div class="message-box mb-3">
				<div class="message-box-inner">
					<div class="message-body">
						<a><h2 id="title01" style="text-align: center;"></h2></a>
					</div>
				</div>
			</div>

			<div class="b-table-box flex-col-1" role="table" aria-label="1단 테이블">
				<div class="b-row-box" role="row">
					<div class="b-row-item">
						<div class="b-title-box" role="rowheader" style="flex:15%; max-width: 15%">
							<label class="">교과목명 및 분반</label>
						</div>
						<div class="b-con-box" role="cell">
							<label id="subjNmclassNo"></label>

						</div>
					</div>
				</div>
				<div class="b-row-box" role="row">
					<div class="b-row-item">
						<div class="b-title-box" role="rowheader" style="flex:15%; max-width: 15%">
							<label class="">강좌 개설 학과 및 개설학년</label>
						</div>
						<div class="b-con-box" role="cell">
							<label id="deptCdstdtYearGcd"></label>
						</div>
					</div>
				</div>
				<div class="b-row-box" role="row">
					<div class="b-row-item">
						<div class="b-title-box" role="rowheader" style="flex:15%; max-width: 15%">
							<label class="">이수구분</label>
						</div>
						<div class="b-con-box" role="cell">
							<label id="subjGcdNm"></label>
						</div>
					</div>
				</div>
				<div class="b-row-box" role="row">
					<div class="b-row-item">
						<div class="b-title-box" role="rowheader" style="flex:15%; max-width: 15%">
							<label>담당교수명</label>
						</div>
						<div class="b-con-box" role="cell">
							<label id="Nm"></label>
						</div>
					</div>
				</div>
			</div>
			
			<div class="table-box">
				<div class="table-body">
					<table class="table table-hover" data-toggle="table"  data-show-column="true">
						<caption>문항항목평점정보</caption>
						<colgroup>
							<col style="min-width: 70px;">
							<col style="min-width: 300px;">
							<col style="min-width: 70px;">
						</colgroup>
						<thead>
							<tr>
								<th scope="col">문항번호</th>
								<th scope="col">항목</th>
								<th scope="col">평점</th>
							</tr>
						</thead>
						<tbody id="resultTbody">
						</tbody>
					</table>
				</div>
			</div>
			
		</div>
	</section>
</div>
<script type="text/x-tbody-template" id="resultTemplate">
	<tr style="cursor:pointer;">
        <td class="text-center">#:QUESTION_NO#</td>
	    <td class="text-left">#:QUESTION_KOR_CONTENT#</td>
	    <td class="text-right">#:AVG_SCORE#</td>
	</tr>
</script>
<script type="text/javascript">
	$(document).ready(popInit());

	function popInit() {
		var syear = scwin.detailObj.SYEAR;
		var termGcdNm = scwin.detailObj.TERM_GCD_NM;
		var subjNm = scwin.detailObj.SUBJ_NM;
		var classNo = scwin.detailObj.CLASS_NO;
		var deptKorNm = scwin.detailObj.DEPT_KOR_NM;
		var openStdtYearGcdNm = scwin.detailObj.OPEN_STDT_YEAR_GCD_NM;
		var subjGcdNm = scwin.detailObj.SUBJ_GCD_NM;
		var Nm = scwin.detailObj.NM;

		$("h2[id='title01']").text(syear + ' 학년도 ' + termGcdNm + ' 강의평가 결과표');
		$("label[id='subjNmclassNo']").text(subjNm + ', ' + classNo + '분반');
		$("label[id='deptCdstdtYearGcd']").text(
				deptKorNm + ', ' + openStdtYearGcdNm);
		$("label[id='subjGcdNm']").text(subjGcdNm);
		$("label[id='Nm']").text(Nm);
		
		
		SearchDetailInfo();
	}
	
	function SearchDetailInfo(){
			
		gfn_ajax_request({
			url : "/ost/sj/kp/lecevalresultsearch/selectLecevalResultDetail",
			reqData : scwin.detailObj,
			success : function(data, responseData) {
				$("#resultTbody").listView(
						{
							dataSource : data,
							dataBound : function(e) {

						
							},
							template : $("#resultTemplate"),
							totalCnt : responseData.totalCnt,
							excel : "fn_excelDownload"
						});
			}
		});
	}
	function fn_excelDownload() {

		data = scwin.detailObj;
		data.pageSize = totalCnt; //전체데이터를 가지고 오기 위해서 pageSize를 전체건수로 세팅
		gfn_ajax_request({
			url : "/ost/sj/kp/lecevalresultsearch/selectLecevalResultDetail",
			reqData : data,
			success : function(data, responseData) {
				if (data.length > 0) {
					/* [엑셀다운로드 공통] */
					gfn_com_excelDownloadFile([ {
						key : "QUESTION_NO",
						name : "문항번호"
					}, {
						key : "QUESTION_KOR_CONTENT",
						name : "항목"
					}, {
						key : "AVG_SCORE",
						name : "평점"
					}], /* 엑셀에 표시할 컬럼 및 명칭 */
					data, /* 엑셀로 다운로드 할 데이터 */
					"강의평가_결과" /* 엑셀로 다운로드 할 파일명 (확장자제외) */
					);
				} else {
					alert("엑셀로 다운로드할 데이터가 없습니다.");
					return false;
				}
			}
		});
	}
	
</script>